<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rainy Forest Animation</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000;
            font-family: Arial, sans-serif;
        }
        
        canvas {
            display: block;
            cursor: none;
        }
        
        .info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            z-index: 10;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }
          
    </style>
</head>
<body>
    <div class="info">
        Rainy Forest Scene â€¢ Press any key for lightning
    </div>
    <canvas id="forestCanvas"></canvas>

    <script>
        const canvas = document.getElementById('forestCanvas');
        const ctx = canvas.getContext('2d');
        
        // Set canvas to full screen
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        const backgroundImage = new Image();
        backgroundImage.crossOrigin = "anonymous";
        backgroundImage.src = "https://plus.unsplash.com/premium_photo-1666902065441-dc3be5a05928?fm=jpg&q=60&w=3000&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8ZGFyayUyMGdyZWVuJTIwZm9yZXN0fGVufDB8fDB8fHww";
        
        // Animation variables
        let mistParticles = [];
        let lightningFlash = 0;
        let lightningTimer = 0;
        
        let rainArr = [];
        const rainSpeed = 4;
        const dropCount = 500;
        
        // Tree silhouette paths for different tree types
        const treeShapes = {
            pine: [
                // Pine tree 1
                [[0.5, 1], [0.3, 0.8], [0.4, 0.8], [0.2, 0.6], [0.3, 0.6], [0.1, 0.4], [0.2, 0.4], [0, 0.2], [0.5, 0], [1, 0.2], [0.8, 0.4], [0.9, 0.4], [0.7, 0.6], [0.8, 0.6], [0.6, 0.8], [0.7, 0.8]],
                // Pine tree 2
                [[0.5, 1], [0.35, 0.85], [0.4, 0.85], [0.25, 0.65], [0.3, 0.65], [0.15, 0.45], [0.2, 0.45], [0.05, 0.25], [0.5, 0], [0.95, 0.25], [0.8, 0.45], [0.85, 0.45], [0.7, 0.65], [0.75, 0.65], [0.6, 0.85], [0.65, 0.85]]
            ],
            oak: [
                // Oak tree 1
                [[0.5, 1], [0.45, 0.9], [0.4, 0.85], [0.3, 0.8], [0.25, 0.7], [0.2, 0.6], [0.15, 0.5], [0.1, 0.4], [0.2, 0.3], [0.3, 0.25], [0.4, 0.2], [0.5, 0.15], [0.6, 0.2], [0.7, 0.25], [0.8, 0.3], [0.9, 0.4], [0.85, 0.5], [0.8, 0.6], [0.75, 0.7], [0.7, 0.8], [0.6, 0.85], [0.55, 0.9]],
                // Oak tree 2
                [[0.5, 1], [0.4, 0.9], [0.35, 0.85], [0.25, 0.8], [0.2, 0.7], [0.15, 0.6], [0.1, 0.5], [0.05, 0.4], [0.15, 0.3], [0.25, 0.25], [0.35, 0.2], [0.5, 0.1], [0.65, 0.2], [0.75, 0.25], [0.85, 0.3], [0.95, 0.4], [0.9, 0.5], [0.85, 0.6], [0.8, 0.7], [0.75, 0.8], [0.65, 0.85], [0.6, 0.9]]
            ]
        };
        
        
        // Initialize mist particles
        function createMistParticle() {
            return {
                x: Math.random() * canvas.width,
                y: canvas.height * 0.7 + Math.random() * canvas.height * 0.3,
                radius: Math.random() * 60 + 20,
                opacity: Math.random() * 0.3 + 0.1,
                speedX: (Math.random() - 0.5) * 0.5,
                speedY: (Math.random() - 0.5) * 0.2
            };
        }
        
        // Initialize particles
        
        for (let i = 0; i < 15; i++) {
            mistParticles.push(createMistParticle());
        }
        
        function createRain() {
            rainArr = [];
            for (let i = 0; i < dropCount; i++) {
                rainArr.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    z: Math.random() * 0.5 + 0.5, // thickness
                    w: Math.floor(Math.random() * 3 + 2), // fall speed
                });
            }
        }
        
        function drawBackground() {
            if (backgroundImage.complete) {
                // Calculate scaling to cover the entire canvas while maintaining aspect ratio
                const scale = Math.max(canvas.width / backgroundImage.width, canvas.height / backgroundImage.height);
                const scaledWidth = backgroundImage.width * scale;
                const scaledHeight = backgroundImage.height * scale;
                const x = (canvas.width - scaledWidth) / 2;
                const y = (canvas.height - scaledHeight) / 2;
                
                ctx.drawImage(backgroundImage, x, y, scaledWidth, scaledHeight);
            } else {
                // Fallback gradient while image loads
                const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                gradient.addColorStop(0, '#1a1a2e');
                gradient.addColorStop(0.3, '#16213e');
                gradient.addColorStop(0.6, '#0f3460');
                gradient.addColorStop(1, '#0e2954');
                
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
        }
        
        // Draw tree silhouette
        function drawTree(x, y, width, height, shape, color) {
            ctx.save();
            ctx.translate(x, y);
            ctx.scale(width, height);
            
            ctx.fillStyle = color;
            ctx.beginPath();
            
            const points = shape[Math.floor(Math.random() * shape.length)];
            ctx.moveTo(points[0][0] * 100, points[0][1] * 100);
            
            for (let i = 1; i < points.length; i++) {
                ctx.lineTo(points[i][0] * 100, points[i][1] * 100);
            }
            
            ctx.closePath();
            ctx.fill();
            ctx.restore();
        }
        
        // Draw forest layers
        function drawForest() {
            const layers = [
                { color: '#0a1a0a', scale: 1.2, yOffset: 0.1 },
                { color: '#0f2f0f', scale: 1.0, yOffset: 0.15 },
                { color: '#143314', scale: 0.8, yOffset: 0.2 },
                { color: '#1a4d1a', scale: 0.6, yOffset: 0.25 }
            ];
            
            layers.forEach((layer, layerIndex) => {
                const treeCount = 8 + layerIndex * 3;
                const baseY = canvas.height * (0.4 + layer.yOffset);
                
                for (let i = 0; i < treeCount; i++) {
                    const x = (canvas.width / treeCount) * i + Math.random() * 100 - 50;
                    const treeType = Math.random() > 0.6 ? 'pine' : 'oak';
                    const width = (50 + Math.random() * 50) * layer.scale;
                    const height = (100 + Math.random() * 100) * layer.scale;
                    
                    drawTree(x, baseY, width, height, treeShapes[treeType], layer.color);
                }
            });
        }
        
        // Draw mist
        function drawMist() {
            mistParticles.forEach(particle => {
                const gradient = ctx.createRadialGradient(
                    particle.x, particle.y, 0,
                    particle.x, particle.y, particle.radius
                );
                gradient.addColorStop(0, `rgba(200, 200, 220, ${particle.opacity})`);
                gradient.addColorStop(1, 'rgba(200, 200, 220, 0)');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);
                ctx.fill();
                
                // Update mist movement
                particle.x += particle.speedX;
                particle.y += particle.speedY;
                
                // Wrap around screen
                if (particle.x > canvas.width + particle.radius) particle.x = -particle.radius;
                if (particle.x < -particle.radius) particle.x = canvas.width + particle.radius;
                if (particle.y > canvas.height + particle.radius) particle.y = canvas.height * 0.7 - particle.radius;
                if (particle.y < canvas.height * 0.7 - particle.radius) particle.y = canvas.height + particle.radius;
            });
        }
        
        function drawRain() {
            ctx.fillStyle = "rgba(200, 200, 255, 0.3)";
            
            for (let i = 0; i < rainArr.length; i++) {
                const drop = rainArr[i];
                ctx.fillRect(drop.x, drop.y, drop.z, 5); // thin vertical line
                
                drop.y += drop.w * rainSpeed;
                drop.x -= 2; // slant left for diagonal effect

                // Reset when drops leave screen
                if (drop.y > canvas.height) {
                    drop.y = -20;
                    drop.x = Math.random() * canvas.width;
                }
            }
        }
        
        // Draw ground reflection
        function drawGroundReflection() {
            const gradient = ctx.createLinearGradient(0, canvas.height * 0.85, 0, canvas.height);
            gradient.addColorStop(0, 'rgba(100, 100, 120, 0.1)');
            gradient.addColorStop(0.5, 'rgba(150, 150, 170, 0.2)');
            gradient.addColorStop(1, 'rgba(100, 100, 120, 0.1)');
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, canvas.height * 0.85, canvas.width, canvas.height * 0.15);
            
            // Add subtle ripple effect
            const time = Date.now() * 0.001;
            ctx.strokeStyle = 'rgba(200, 200, 220, 0.1)';
            ctx.lineWidth = 1;
            
            for (let i = 0; i < 5; i++) {
                const y = canvas.height * 0.9 + Math.sin(time + i) * 5;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }
        
        // Lightning effect
        function drawLightning() {
            if (lightningFlash > 0) {
                ctx.fillStyle = `rgba(255, 255, 255, ${lightningFlash})`;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                lightningFlash -= 0.05;
            }
            
            // Random lightning strikes
            lightningTimer++;
            if (lightningTimer > 300 + Math.random() * 600) {
                lightningFlash = 0.3 + Math.random() * 0.4;
                lightningTimer = 0;
            }
        }
        
        // Main animation loop
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            drawBackground();
            drawForest();
            drawMist();
            drawRain();
            drawGroundReflection();
            drawLightning();
            
            requestAnimationFrame(animate);
        }
        
        // Manual lightning trigger
        document.addEventListener('keydown', () => {
            lightningFlash = 0.6;
        });
        
        // Start animation
        createRain();
        animate();
    </script>
</body>
</html>
